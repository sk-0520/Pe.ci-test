<!DOCTYPE html>
<html lang="@[LANG]" xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="utf-8" />
		<title>@[APPLICATION:NAME]: @{html-viewer/feedback/title}</title>
		@[HTML:STYLE-COMMON]
		@[HTML:STYLE-CUSTOM]
		@[HTML:SCRIPT-COMMON]
		@[HTML:SCRIPT-CUSTOM]
		<script>
			$(function() {
				// 自動入力工区の切り替え
				$('#switch-auto-input').click(function(e) {
					e.preventDefault();
					$('#auto-input').slideToggle(250);
					return false;
				});

				// 自動入力項目のキー設定
				$('#auto-input').find('tbody').find('tr').each(function() {
					var $tr = $(this);
					var $value = $tr.find('input[readonly]').first();
					var name = $value.prop('name');
					$tr.find('.auto-key').text(name);
				});

				// autoresize
				$('textarea').autosize();

				// submit
				$('#form').submit(function() {
					trimValue();
					var checkResult = check();
					if (!checkResult.success) {
						alert(checkResult.message)
						return false;
					}
					$('#submit').prop('disabled', true);
				});
			});
			
			function trimValue() {
				$('input[type=text]').each(function() {
					var $input = $(this);
					$input.val($.trim($input.val()));
				});
				$('textarea').each(function() {
					var $textarea = $(this);
					$textarea.val($.trim($textarea.val()));
				})
			}

			function check() {
				var inputList = [
					{ name: 'input-operability', isRadion: true, isMulti: false },
					{ name: 'input-functionality', isRadion: true, isMulti: false },
					{ name: 'input-main', isRadion: false, isMulti: true },
					{ name: 'input-function', isRadion: false, isMulti: false },
					{ name: 'input-failure', isRadion: false, isMulti: false },
					{ name: 'input-others', isRadion: false, isMulti: false }
				];
				var notInputCount = 0;
				for (var i = 0, iMax = inputList.length; i < iMax; i++) {
					var inputItem = inputList[i];
					var $input = $('[name=' + inputItem.name + ']');
					if (inputItem.isMulti) {
						var hasValueCount = 0;
						for (var j = 0, jMax = $input.length; j < jMax; j++) {
							if ($($input[j]).prop('checked')) {
								hasValueCount += 1;
							}
						}
						if (!hasValueCount) {
							notInputCount += 1;
						}
					} else if(inputItem.isRadion) {
						if(!$('[name=' + inputItem.name + ']:checked').val().length) {
							notInputCount += 1;
						}
					} else if(!$.trim($input.val()).length) {
						notInputCount += 1;
					}
				}
				if (inputList.length == notInputCount) {
					return {
						success: false,
						message: [
							'* @{html-viewer/feedback/operability}',
							'* @{html-viewer/feedback/functionality}',
							'* @{html-viewer/feedback/main}',
							'* @{html-viewer/feedback/function}',
							'* @{html-viewer/feedback/failure}',
							'* @{html-viewer/feedback/others}',
							'--------------',
							'@{html-viewer/feedback/local/not-input}'
						].join("\r\n")
					};
				}
				return {
					success: true
				};
			}
		</script>
	</head>
	<body oncontextmenu="return false;">
		<h1>@{html-viewer/feedback/title}</h1>
		<p id="message">@{html-viewer/feedback/message}</p>
		<form id="form" action="@[URI-FEEDBACK]" method="post">
			<div style="display: none">
				<input type="hidden" name="app-key" value="FEEDBACK" />
				<input type="hidden" name="msg-title"   value="@{html-viewer/feedback/message/title}" />
				<input type="hidden" name="msg-success" value="@{html-viewer/feedback/message/success}" />
				<input type="hidden" name="msg-failure" value="@{html-viewer/feedback/message/failure}" />
				<input type="hidden" name="msg-message" value="@{html-viewer/feedback/message/message}" />
			</div>
			<ul class="questionnaire">
				<li class="item">
					<p><!--操作性-->@{html-viewer/feedback/operability}</p>
					<div class="input">
						<ul class="level">
							<li class="unset"><label><input type="radio" name="input-operability" value="" checked="checked" />@{html-viewer/feedback/operability/unset}</label></li>
							<li class="good">@{html-viewer/feedback/operability/good}</li>
							<li><input type="radio" name="input-operability" value="5" /></li>
							<li><input type="radio" name="input-operability" value="4" /></li>
							<li><input type="radio" name="input-operability" value="3" /></li>
							<li><input type="radio" name="input-operability" value="2" /></li>
							<li><input type="radio" name="input-operability" value="1" /></li>
							<li class="bad">@{html-viewer/feedback/operability/bad}</li>
						</ul>
					</div>
				</li>
				<li class="item">
					<p><!--機能性-->@{html-viewer/feedback/functionality}</p>
					<div class="input">
						<ul class="level">
							<li class="unset"><label><input type="radio" name="input-functionality" value="" checked="checked" />@{html-viewer/feedback/functionality/unset}</label></li>
							<li class="good">@{html-viewer/feedback/functionality/good}</li>
							<li><input type="radio" name="input-functionality" value="5" /></li>
							<li><input type="radio" name="input-functionality" value="4" /></li>
							<li><input type="radio" name="input-functionality" value="3" /></li>
							<li><input type="radio" name="input-functionality" value="2" /></li>
							<li><input type="radio" name="input-functionality" value="1" /></li>
							<li class="bad">@{html-viewer/feedback/functionality/bad}</li>
						</ul>
					</div>
				</li>
				<li class="item">
					<p><!--主に使用するの機能-->@{html-viewer/feedback/main}</p>
					<div class="input">
						<ul class="main">
							<li><label><input name="input-main" type="checkbox" value="100:toolbar"   />@{html-viewer/feedback/main/toolbar}</label></li>
							<li><label><input name="input-main" type="checkbox" value="200:command"   />@{html-viewer/feedback/main/command}</label></li>
							<li><label><input name="input-main" type="checkbox" value="300:note"      />@{html-viewer/feedback/main/note}</label></li>
							<li><label><input name="input-main" type="checkbox" value="400:clipboard" />@{html-viewer/feedback/main/clipboard}</label></li>
							<li><label><input name="input-main" type="checkbox" value="500:template"  />@{html-viewer/feedback/main/template}</label></li>
						</ul>
					</div>
				</li>
				<li class="item">
					<p><!--機能要望-->@{html-viewer/feedback/function}</p>
					<div class="input">
						<textarea name="input-function"></textarea>
					</div>
				</li>
				<li class="item">
					<p><!--不具合報告-->@{html-viewer/feedback/failure}</p>
					<div class="input">
						<textarea name="input-failure"></textarea>
					</div>
				</li>
				<li class="item">
					<p><!--その他-->@{html-viewer/feedback/others}</p>
					<div class="input">
						<textarea name="input-others"></textarea>
					</div>
				</li>
				<li class="item">
					<p><!--自動入力-->@{html-viewer/feedback/auto}(<button id="switch-auto-input">@{html-viewer/feedback/auto/swicth}</button>)</p>
					<div id="auto-input" class="input" style="display: none;">
						<table>
							<thead>
								<tr>
									<th>@{html-viewer/feedback/auto/key}</th>
									<th>@{html-viewer/feedback/auto/value}</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-id" readonly="readonly" value="@[USER-SETTING:USER-ID]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-version" readonly="readonly" value="@[APPLICATION:VERSION]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-build" readonly="readonly" value="@[APPLICATION:BUILD]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-os" readonly="readonly" value="@[ENVIRONMENT:OS]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-clr" readonly="readonly" value="@[ENVIRONMENT:CLR]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-cpu-sys" readonly="readonly" value="@[ENVIRONMENT:CPU]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-cpu-app" readonly="readonly" value="@[APPLICATION:CPU]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-memory" readonly="readonly" value="@[ENVIRONMENT:MEMORY]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-display-count" readonly="readonly" value="@[ENVIRONMENT:DISPLAY-COUNT]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-lang-sys" readonly="readonly" value="@[ENVIRONMENT:LANGUAGE]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-lang-app" readonly="readonly" value="@[APPLICATION:LANGUAGE]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-first-version" readonly="readonly" value="@[APPLICATION:FIRST-VERSION]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-first-timestamp" readonly="readonly" value="@[APPLICATION:FIRST-TIMESTAMP]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="auto-execute-count" readonly="readonly" value="@[APPLICATION:EXECUTE-COUNT]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="setting-dir" readonly="readonly" value="@[USER-SETTING:DIR]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="setting-clipboard-count" readonly="readonly" value="@[USER-SETTING:CLIPBOARD-COUNT]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="setting-template-count" readonly="readonly" value="@[USER-SETTING:TEMPLATE-COUNT]" /></td>
								</tr>
								<tr>
									<td class="auto-key"></td>
									<td><input type="text" name="setting-note-count" readonly="readonly" value="@[USER-SETTING:NOTE-COUNT]" /></td>
								</tr>
							</tbody>
						</table>
					</div>
				</li>
				<li class="item">
					<p><!--ユーザー確認項目-->@{html-viewer/feedback/confirm}</p>
					<ul>
						<li>
							<label><input type="checkbox" name="app-confirm" value="true" />@{html-viewer/feedback/confirm/confirm}</label>
							<p class="comment">@{html-viewer/feedback/confirm/confirm-comment}</p>
						</li>
						<li>
							<label><span class="title">@{html-viewer/feedback/confirm/mail}</span><input type="text" name="input-user-mail" /></label>
							<p class="comment">@{html-viewer/feedback/confirm/mail-comment}</p>
						</li>
						<li>
							<label><span class="title">@{html-viewer/feedback/confirm/name}</span><input type="text" name="input-user-name" /></label>
							<p class="comment">@{html-viewer/feedback/confirm/name-comment}</p>
						</li>
					</ul>
				</li>
			</ul>
			<p class="warning">
				@{html-viewer/feedback/warning}
			</p>
			<div class="action">
				<input id="submit" type="submit" value="@{html-viewer/feedback/submit}" />
			</div>
		</form>
	</body>
</html>
